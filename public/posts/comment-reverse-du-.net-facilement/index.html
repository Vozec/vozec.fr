<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/vozec.fr/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/images/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Vozec&#39;s Blog - Comment Reverse du .Net facilement</title>
<meta property="og:title" content=Vozec&#39;s&#32;Blog&#32;-&#32;Comment&#32;Reverse&#32;du&#32;.Net&#32;facilement />
<meta name="twitter:title" content=Vozec&#39;s&#32;Blog&#32;-&#32;Comment&#32;Reverse&#32;du&#32;.Net&#32;facilement />
<meta itemprop="name" content=Vozec&#39;s&#32;Blog&#32;-&#32;Comment&#32;Reverse&#32;du&#32;.Net&#32;facilement />
<meta name="application-name" content=Vozec&#39;s&#32;Blog&#32;-&#32;Comment&#32;Reverse&#32;du&#32;.Net&#32;facilement />
<meta property="og:site_name" content="" />


<meta name="description" content="Comment Reverse du .Net facilement. Part1" />
<meta itemprop="description" content="Comment Reverse du .Net facilement. Part1" />
<meta property="og:description" content="Comment Reverse du .Net facilement. Part1" />
<meta name="twitter:description" content="Comment Reverse du .Net facilement. Part1" />


<base href="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/" />
<link rel="canonical" href="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/" itemprop="url" />
<meta name="url" content="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/" />
<meta name="twitter:url" content="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/" />
<meta property="og:url" content="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/" />


<meta property="og:updated_time" content="2021-10-24T12:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://vozec.github.io/vozec.fr/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="https://twitter.com/Vozec1" />
<meta name="twitter:creator" content="https://twitter.com/Vozec1" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.134.1">


    
    

<link type="text/css" rel="stylesheet" href="/vozec.fr/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://vozec.github.io/vozec.fr/">
                <img src="https://avatars.githubusercontent.com/u/61807609?v=4" alt="brand image">
            </a>
        
        
            <a href="https://vozec.github.io/vozec.fr/">
                <h1>Vozec&#39;s Blog</h1>
            </a>
        
    </h1>
    <p class="lead">
    A student passionate about cybersecurity
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/researchs/">Researchs</a>
                    </li>
                    
                
            
                
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/rsa/">1/ Crypto RSA</a>
                    </li>
                    
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/aes/">2/ Crypto AES</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/other/">3/ Crypto Other</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/Vozec">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/arthur-dlfr/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>


    <a target="_blank" class="social" title="Twitter" href="https://twitter.com/Vozec1">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M5.032 14.286c6.037 0 9.34-4.837 9.34-9.032c0-.137 0-.274-.01-.41A6.56 6.56 0 0 0 16 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207 0 0 0 1.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322 0 0 0-1.862-.958a3.384 3.384 0 0 0-2.082.334a3.223 3.223 0 0 0-1.442 1.49a3.08 3.08 0 0 0-.208 2.03a9.57 9.57 0 0 1-3.747-.963a9.269 9.269 0 0 1-3.018-2.354a3.086 3.086 0 0 0-.36 2.314c.189.787.68 1.475 1.376 1.924a3.344 3.344 0 0 1-1.49-.398v.04c0 .734.263 1.444.743 2.01a3.3 3.3 0 0 0 1.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19 0 0 0 1.168 1.577a3.36 3.36 0 0 0 1.9.627A6.732 6.732 0 0 1 0 12.86a9.527 9.527 0 0 0 5.032 1.423"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="Discord" href="vozec">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
        </svg>
    </a>










    <a target="_blank" class="social" title="Email" href="https://www.root-me.org/Vozec">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>


        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://vozec.github.io/vozec.fr/posts/comment-reverse-du-.net-facilement/">Comment Reverse du .Net facilement</a>
  </h1>

  <div class="headline">
    <div>
      
      <time datetime=" 2021-10-24T12:00:00Z" class="post-date">
        October 24, 2021
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>7 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-reverse">
        <a href="https://vozec.github.io/vozec.fr/tags/reverse">reverse</a>
      </li>
      
      <li class="tag-tuto">
        <a href="https://vozec.github.io/vozec.fr/tags/tuto">tuto</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <h2 id="--created-by-vozec-23102021">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
$(document).ready(function() {
    var ctrlDown = false,
        ctrlKey = 17,
        cmdKey = 91,
        vKey = 86,
        cKey = 67;

    $(document).keydown(function(e) {
        if (e.keyCode == ctrlKey || e.keyCode == cmdKey) ctrlDown = true;
    }).keyup(function(e) {
        if (e.keyCode == ctrlKey || e.keyCode == cmdKey) ctrlDown = false;
    });
    $(document).keydown(function(e) {
        if (ctrlDown && (e.keyCode == cKey)) window.location.href = "https://www.youtube.com/watch?v=cvh0nX08nRw";
        if (ctrlDown && (e.keyCode == vKey)) window.location.href = "https://www.youtube.com/watch?v=cvh0nX08nRw";
    });
});
</script>


[//]: &lt;&gt; (Created By Vozec 23/10/2021)</h2>
<h2 id="nécessaires">Nécessaires</h2>
<ul>
<li><a href="./files/DotNetPack.rar">Ce pack complet pour l&rsquo;obfuscation C#</a></li>
</ul>
<hr>
<h2 id="introduction">Introduction</h2>
<p>.Net est un langage assez facile à reverse en général. Grâce à de simples outils comme JetBrain Dotpeek , DnSpy ou Ilspy , on peut facilement débugger , éditer , patcher un assembly sans soucis .
La principale difficulté et la multitude de protection qui existe autour du Framework de Microsoft (.Net Framework/Core).
Nous allons donc voir quelles sont les principales sécurités et comment les contourner.</p>
<h2 id="vocabulaire">Vocabulaire</h2>
<p>Pour simplifier la lecture et la compréhension, nous allons définir ce vocabulaire :</p>
<ul>
<li>
<p><strong>Obfu</strong> : &ldquo;obfuscate&rdquo; : Le code n&rsquo;est pas lisible ou difficilement</p>
</li>
<li>
<p><strong>Packer</strong> : Un packer est un logiciel qui permet de packer des assembly .net</p>
<ul>
<li>Un assembly packé et un assembly englobé dans une machine virtuelle crée pour l&rsquo;exécutable<br>
<img src="./img/packerexplications.png" alt="Alt text" title="packershema"></li>
</ul>
</li>
<li>
<p><strong>Dump</strong> : Un Dump de manière général est une copie. Dans notre cas, ce sera une copie de la mémoire RAM de votre pc. Quand on dump un processus, on copie tout ce qui touche à ce processus dans la mémoire vive.</p>
</li>
<li>
<p><strong>Breakpoint/Point d&rsquo;arrêt</strong> : Endroit d&rsquo;un programme ou celui-ci va se figer, c&rsquo;est utile pour mettre en pause un programme et l&rsquo;analyser à un endroit précis.</p>
</li>
</ul>
<h4 id="debugging">Debugging</h4>
<p>Nous avons la possibilité de debugger notre code grâce à DnSpy par exemple .<br>
Il est primordial de comprendre et de savoir utiliser cet outil pour la suite .</p>
<p><img src="./img/dnspy.png" alt="Alt text" title="dnspy"></p>
<p>C&rsquo;est très utile pour récupérer la valeure d&rsquo;une variable secrète, uniquement définie dans le code et non affichée dans la console.</p>
<h2 id="reverse">Reverse</h2>
<p>La première chose à faire quand on veut reverse un assembly et de connaitre quel compilateur a était utilisé , Pour ce faire , on utilise <strong>DIE</strong> , (<em>DetectItEasy</em>)</p>
<p>Disponible dans le pack plus haut</p>
<p><img src="./img/die.png" alt="Alt text" title="die1"><img src="./img/die2.png" alt="Alt text" title="die2"><br>
On remarque bien la différence entre un exécutable packé et un autre non packé<br>
On retrouve aussi cette différence sur <a href="https://github.com/dnSpy/dnSpy" target="_blank">DnSpy</a> :<br>
(En Haut les class visibles du premier .exe et en dessous , le deuxième .exe qui ne semble pas &lsquo;debuggable&rsquo;)</p>
<p><img src="./img/diffpacked.png" alt="Alt text" title="diffpacked"></p>
<h2 id="packer-">Packer :</h2>
<p>Si vous êtes dans le cas n°2 , vous avez uniquement &lsquo;PE&rsquo; sur DnSpy
Il y a 2 possibilités, la première est que votre assembly n&rsquo;est pas en .Net , si c&rsquo;est le cas ; que faites-vous là ?
Sinon , c&rsquo;est que votre assembly est packé , il nous faut donc l&rsquo;extraire pour avoir se retrouver dans le cas similaire au premier .exe du screen .</p>
<p>Deux Solutions se présentent à vous</p>
<p><strong>La première</strong> est de trouver le packer utilisé.
Dans nos futur cas, le packer utilisé sera BoxedAppPacker qui est facilement réversible pour vos premier crackme : <a href="https://github.com/MindSystemm/BoxedAppUnpacked" target="_blank">Boxed_Unpacker</a></p>
<p><img src="./img/boxedunpacker.png" alt="Alt text" title="unpacked_boxed"></p>
<p><strong>La seconde</strong> est d&rsquo;utiliser un Dumper pour reconstruire à partie de la mémoire un .exe qui a déjà était extrait (voir définition <em>packer</em> plus haut) . On aura ainsi le .exe original sans toutes la VM autour.</p>
<p>De manière plus général, on peut utiliser des &lsquo;dumper&rsquo; comme :</p>
<ul>
<li>MegaDumper.exe</li>
<li>ExtremeDumper.exe (Le plus user-friendly)</li>
<li>X64NetDumper.exe  (La base de tous les autres)</li>
<li>Nemesis.exe</li>
</ul>
<p>Il ne faut pas hésiter à modifier le nom de votre dumper. Les programmes étant connus, certaines protections kill le programme si elles détectent un processus de dump :</p>
<p><img src="./img/antidump2.png" alt="Alt text" title="antidump"></p>
<p>Ils se présentent généralement de la même façon avec des options identiques
<img src="./img/extremedumper1.png" alt="Alt text" title="dumper"> <img src="./img/extremedumper2.png" alt="Alt text" title="dumper2"></p>
<p>Ouvrons à présent notre assembly avec un code visible.</p>
<ul>
<li>Si vous avez un code propre comme sur le Screenshot précédent, vous avez fini !</li>
<li>Sinon , vous n&rsquo;avez pas de chance .. le code est obfusqué .. Alors désobfusquons le :)</li>
</ul>
<h2 id="désobfuscation">Désobfuscation</h2>
<p>Là encore on retrouve deux méthodes pour parvenir à nos fins:</p>
<ul>
<li>Tous faire à la main</li>
<li>Utiliser les bons outils</li>
</ul>
<p>La solution évidente est la 2nd car même si il est possible de débug du code obfusqué, c&rsquo;est un vrai cauchemar ..</p>
<h5 id="il-faut-déterminer-quel-outils-a-était-utilisé-">Il faut déterminer quel outils a était utilisé .</h5>
<p>La première chose est de regarder le code , les outils d&rsquo;obfuscation laissent souvent des traces<br>
<img src="./img/inx.png" alt="Alt text" title="inxProtector"><br>
<img src="./img/confuse.png" alt="Alt text" title="confuser"></p>
<p>Là, une recherche google est toujours utile pour voir si un Tool pour reverse cette obfucation en particulier existe déjà.<br>
Ce site par exemple est très utile : <a href="https://opensourcelibs.com/lib/.net-deobfuscator" target="_blank">.NET Deobfuscator</a></p>
<p>Si vous ne trouvez pas de Tool ,il y a <strong>De4dot</strong> ! C&rsquo;est un outils qui gère, analyse et simplifie beaucoup le code.<br>
On peut donc décoder le .exe grâce à ces outils génériques :</p>
<ul>
<li>De4dot</li>
<li>Rzy Protector V2 Unpacker</li>
<li>ConfuserEx-Unpacker-v2.0</li>
<li>AntiDecompiler Cleaner</li>
</ul>
<p><em>(Même si vous trouvez un outil pour désobfusquer votre code, un passage dans De4dot est toujours une bonne chose , ne serait-ce que pour le renommage des class par exemple)</em></p>
<p>Il faut donc tester chaque outils plusieurs fois et voir si le fichier de sortie fonctionne toujours et si le code est mieux qu’avant.<br>
Il faut alterner , passer dans l&rsquo;un , puis dans l&rsquo;autre et voir si le code devient plus clair. C&rsquo;est le cas dans la plupart du temps.<br>
<strong>Même</strong> si le programme n&rsquo;est pas packé , <strong>un dump peut toujours simplifier les choses .</strong>
<img src="./img/de4dot.png" alt="Alt text" title="de4dot"></p>
<p><strong>On peut bypass l&rsquo;obfuscation du .exe</strong> sans sauvegarder le process .<em><strong>(Cas Rare)</strong></em>
L&rsquo;idée est de débug le .exe jusqu&rsquo;a ce qu&rsquo;il passe toute les sécurités puis reconstruire l&rsquo;assembly sans ces sécurités tout en gardant le processus ouvert pour ne pas ré-avoir l&rsquo;obfuscation dans le nouveau processus:</p>
<h4 id="comment-"><em>Comment ?</em></h4>
<p>On met un breakpoint après la sécurité . On peut modifier les instructions <em>IL</em> et on relance le programme avec la flèche du haut. Là , Dnspy va recréer un code à partir de là ou il était et donc vous aurait votre code débusqué .Le soucis est que vous devez tous faire en runtime par la suite : si vous sauvegarder votre .exe , il ne fonctionnera pas . Vous devez donc debug a partir de la ou vous en êtes ,
Comme ceci : 

 <video controls width="100%">
   <source src="./img/manualDUMP1.mp4" type="video/mp4">
 </video>
 
</p>
<p><em>Cette méthode fonctionne mais n&rsquo;est pas très propre et rarement utilisé</em></p>
<h4 id="sinon">Sinon:</h4>
<p><strong>On peut aussi aller sur YouTube et voir comment dump manuellement un type d&rsquo;obfuscation, c&rsquo;est très spécifique a chacun et le breakpoint et difficile a bien placer.</strong></p>
<h2 id="anti-dump-et-anti-ildasm">Anti-Dump et Anti-ILDasm</h2>
<p>C&rsquo;est deux protection empêche le bon fonctionnement des étapes d&rsquo;avant (le dump et l&rsquo;utilisation d&rsquo;outils) .<br>
Nous devons donc supprimer ces protections à la main avant de retenter les étapes précédentes.<br>
Il faut savoir que ces protections sont au tout début de l&rsquo;obfucation.</p>
<p>Nous allons donc faire :
<strong>Clic Droit</strong> (dans l&rsquo;explorateur de solution) <em>&gt;</em> <strong>aller au <!-- raw HTML omitted --> .cctor</strong> et <strong>Placer un breakpoint</strong> après la première sécurité .On peut ensuite Debug et une fois arrivé au breakpoint , sauvegarder le .exe . (Section <em>module</em> en bas)<br>
On réouvre le nouveau .exe et on <strong>supprime</strong> la ligne qu&rsquo;on a passé grâce au <strong>instruction IL</strong> et on re-sauvegarde . Là , la protection sera passé :)</p>
<p><em><strong>Illustration :</strong></em>


<video controls width="100%">
  <source src="./img/antidump.mp4" type="video/mp4">
</video>

</p>
<h2 id="dll-hijacking">DLL Hijacking</h2>
<p>C&rsquo;est de loin ma partie préférée, J&rsquo;ai écris un article <a href="http://vozec.fr/articles/pourquoi-vous-devez-s%C3%A9curiser-vos-dll/" target="_blank">ici</a> !</p>
<h2 id="contournement-de-code-interne">Contournement de Code Interne</h2>
<p>L&rsquo;obfuscation se fait à la fois dans le code et à l&rsquo;extérieur avec différents outils évoqués plus tôt.
Nous allons voir comment contourner ces protections directement placées dans le code :
Imaginons qu&rsquo;il y ai un Anti-Debug , celui ci fonctionne à partir du moment où il est activé . Nous pouvons donc aller jusqu&rsquo;à ce moment puis empêcher l&rsquo;exécution de cette sécurité.
<img src="./img/antidebug.png" alt="Alt text" title="antidebug">
Ici, nous devrions empêcher l&rsquo;exécution de la fonction &ldquo;sécu()&rdquo; . On peut donc faire plusieurs chose.</p>
<h3 id="la-première"><strong>La première</strong></h3>
<p>Est de faire un patch : sur dnspy on peut éditer une class est ainsi on pourrait empêcher l&rsquo;execution. Cette technique marche uniquement si tous le code est propre . Sinon, la recompilation ne sera pas possible.
<img src="./img/edit.png" alt="Alt text" title="edit">
On pourrait aussi supprimer les actions de &ldquo;tktbro()&rdquo; ou modifier la string qui est comparée dans le début du code pour valider la condition du <em>if</em></p>
<h3 id="la-deuxième"><strong>La deuxième</strong></h3>
<p>Est plus facile , elle consiste à modifier les variables du programme lors de son exécution  <em>(=&ldquo;en runtime&rdquo;)</em> .
Dans notre exemple, la fonction <em>sécu()</em> se lance uniquement si 2 variables sont différentes. Une solution serait d&rsquo;aller grâce à un point d&rsquo;arrêt à la comparaison et de modifier les valeurs de sorte que la fonction ne soit pas lancée .
On met dont un point d&rsquo;arrêt sur le <em>if</em> puis on click sur le <em>!=</em> pour arriver dans la fonction de comparaison et on place à nouveau un breakpoint.
<img src="./img/edit2.png" alt="Alt text" title="edit2"></p>
<p><img src="./img/edit3.png" alt="Alt text" title="edit3"></p>
<h1 id="conclusion">Conclusion</h1>
<p><strong>Pour désobfusquer un assembly en .net , il faut :</strong></p>
<ul>
<li>Vérifier qu&rsquo;il packé.</li>
<li>Si oui, le unpack (Dump / Tools automatiques)</li>
<li>Regarder si le code est désobfusqué :</li>
<li>Si ce n&rsquo;est pas le cas : regarder et chercher un désobfuscateur adapté pour votre assembly .</li>
<li>Si vous ne trouvez pas, jouez entre faire des dumps et utiliser des outils comme D4dot</li>
<li>Si vous n&rsquo;avez que des erreurs, dumper manuellement votre process et patché le jusqu&rsquo;à ce que les outils fonctionnent dessus.</li>
<li>Si vous ne parvenez un rien, utiliser les DLL pour récuperer les informations que vous cherchez.</li>
</ul>
<p><strong>J&rsquo;ai créé 9 Crackme</strong> :</p>
<ul>
<li><a href="./files/crackme1.exe">CrackMe1 - Intro</a></li>
<li><a href="./files/crackme2.exe">CrackMe2 - Debugging</a></li>
<li><a href="./files/crackme3.exe">CrackMe3 - Packed</a></li>
<li><a href="./files/crackme4.exe">CrackMe4 - Basic Obfuscation</a></li>
<li><a href="./files/crackme5.exe">CrackMe5 - Anti-Debugging</a></li>
<li><a href="./files/crackme6.rar">CrackMe6 - Dll Hijacking</a></li>
<li><a href="./files/crackme7.exe">CrackMe7 - Apps are cools</a></li>
<li><a href="./files/crackme8.exe">CrackMe8 - Manual Dump</a></li>
<li><a href="./files/crackme9.exe">CrackMe9 - Final</a></li>
</ul>

  
  <hr>
<div class="footer">
    
	    
	    
            <div class="next-post">
                <a href="https://vozec.github.io/vozec.fr/posts/pourquoi-vous-devez-securiser-vos-dll/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Pourquoi il faut sécuriser vos DLL P1</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#--created-by-vozec-23102021">HAHAHUGOSHORTCODE17s0HBHB
[//]: &lt;&gt; (Created By Vozec 23/10/2021)</a></li>
    <li><a href="#nécessaires">Nécessaires</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#vocabulaire">Vocabulaire</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a></li>
    <li><a href="#packer-">Packer :</a></li>
    <li><a href="#désobfuscation">Désobfuscation</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#anti-dump-et-anti-ildasm">Anti-Dump et Anti-ILDasm</a></li>
    <li><a href="#dll-hijacking">DLL Hijacking</a></li>
    <li><a href="#contournement-de-code-interne">Contournement de Code Interne</a>
      <ul>
        <li><a href="#la-première"><strong>La première</strong></a></li>
        <li><a href="#la-deuxième"><strong>La deuxième</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
