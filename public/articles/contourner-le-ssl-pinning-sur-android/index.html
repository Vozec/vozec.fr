<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.ico">

  <title>
    Comment contourner le SSL Pinning sur android - Vozec&#39;s Blog
  </title>

  <meta name="description" content="Comment peut on récupérer le contenue des requètes https dans une application android" />
  <meta name="keywords" content="tuto,android,reverse,ssl,certificat,root,sniffer,sniff,http,https,frida,apktool,jarsigner,apksigner" />
  <meta name="generator" content="Hugo 0.105.0">

  <link rel="stylesheet" href="https://vozec.fr/css/main.css" />

  
  

  <meta property="og:title" content="Comment contourner le SSL Pinning sur android" />
<meta property="og:description" content="Comment peut on récupérer le contenue des requètes https dans une application android" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vozec.fr/articles/contourner-le-ssl-pinning-sur-android/" /><meta property="og:image" content="https://vozec.fr/vozec.png"/><meta property="article:section" content="articles" />
<meta property="article:published_time" content="2021-11-04T12:00:00+00:00" />
<meta property="article:modified_time" content="2021-11-04T12:00:00+00:00" />



  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://vozec.fr/vozec.png"/>

<meta name="twitter:title" content="Comment contourner le SSL Pinning sur android"/>
<meta name="twitter:description" content="Comment peut on récupérer le contenue des requètes https dans une application android"/>


  <meta itemprop="name" content="Comment contourner le SSL Pinning sur android">
<meta itemprop="description" content="Comment peut on récupérer le contenue des requètes https dans une application android"><meta itemprop="datePublished" content="2021-11-04T12:00:00+00:00" />
<meta itemprop="dateModified" content="2021-11-04T12:00:00+00:00" />
<meta itemprop="wordCount" content="1874"><meta itemprop="image" content="https://vozec.fr/vozec.png"/>
<meta itemprop="keywords" content="hacking,tuto,reverse," />

  <meta itemprop="name" content="Comment contourner le SSL Pinning sur android">
<meta itemprop="description" content="Comment peut on récupérer le contenue des requètes https dans une application android"><meta itemprop="datePublished" content="2021-11-04T12:00:00+00:00" />
<meta itemprop="dateModified" content="2021-11-04T12:00:00+00:00" />
<meta itemprop="wordCount" content="1874"><meta itemprop="image" content="https://vozec.fr/vozec.png"/>
<meta itemprop="keywords" content="hacking,tuto,reverse," />
</head><body class="flex relative h-full min-h-screen"><aside
  class="will-change-transform transform transition-transform -translate-x-full absolute top-0 left-0 md:relative md:translate-x-0 w-3/4 md:w-60 h-full min-h-screen p-3 bg-slate-50 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col gap-2.5 z-20 sidebar">
  <p class="font-bold mb-5 flex items-center gap-2">
    <button aria-label="Close sidebar"
      class="md:hidden menu-trigger-close p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-6 w-6" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg></button>
    <a href="https://vozec.fr/" class="px-2">
      <span>Vozec&#39;s Blog</span>
    </a>
    <button aria-label="Toggle dark mode"
      class="dark-mode-toggle p-2 rounded border dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <circle cx="12" cy="12" r="4" />
  <path d="M3 12h1M12 3v1M20 12h1M12 20v1M5.6 5.6l.7 .7M18.4 5.6l-.7 .7M17.7 17.7l.7 .7M6.3 17.7l-.7 .7" />
</svg></button>
  </p>

  
  <ul class="list-none flex flex-col gap-1">
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/" >
        <span>Home</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>C͟o͟n͟t͟e͟n͟t͟ ✒️</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles" >
        <span> 〰️ Articles</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/writeups" >
        <span> 〰️ Writeups</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>F͟r͟o͟m͟ 0 T͟o͟ C͟r͟y͟p͟t͟o͟ 🔐</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-rsa" >
        <span> 〰️ Rsa Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-aes" >
        <span> 〰️ Aes Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-other" >
        <span> 〰️ Other Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>A͟b͟o͟u͟t͟ M͟e͟👀</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/contact" >
        <span> 〰️ Contact Me</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://flag-poisoning.fr"  target="_blank"
        rel="noopener" >
        <span> 〰️ My Ctf Team </span>
        
        <span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <path d="M11 7h-5a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-5" />
  <line x1="10" y1="14" x2="20" y2="4" />
  <polyline points="15 4 20 4 20 9" />
</svg></span>
        
      </a>
    </li>
    
  </ul>

  <div class="flex-1"></div>

  

  <ul class="list-none flex flex-wrap justify-center gap-1 pt-2 border-t border-slate-200 dark:border-slate-600">
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://twitter.com/Vozec1" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Twitter</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path
    d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://github.com/Vozec" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">GitHub</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path
    d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://www.linkedin.com/in/arthur-deloffre-844b7a221/" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">LinkedIn</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
  <rect x="2" y="9" width="4" height="12" />
  <circle cx="4" cy="4" r="2" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="mailto:arthursd444@gmail.com" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Email</span>
        
        <span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <rect x="3" y="5" width="18" height="14" rx="2" />
  <polyline points="3 7 12 13 21 7" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://www.instagram.com/arthur_dlfr/" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Instagram</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <rect x="2" y="2" width="20" height="20" rx="5" ry="5" />
  <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
  <line x1="17.5" y1="6.5" x2="17.51" y2="6.5" />
</svg></span>
        
      </a>
    </li>
    
  </ul>
</aside>

<div
  class="fixed bg-slate-700 bg-opacity-5 transition duration-200 ease-in-out inset-0 z-10 pointer-events-auto md:hidden left-0 top-0 w-full h-full hidden menu-overlay">
</div>

<button aria-label="Toggle Sidebar"
  class="md:hidden absolute top-3 left-3 z-10 menu-trigger p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-100"><svg class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <line x1="4" y1="6" x2="20" y2="6" />
  <line x1="4" y1="12" x2="20" y2="12" />
  <line x1="4" y1="18" x2="16" y2="18" />
</svg></button>
<div class="flex-1">





<div class="flex h-screen relative">

  <section
    class="will-change-transform transform transition-transform -translate-x-[200%] absolute top-0 left-0 lg:relative
  lg:translate-x-0 lg:min-w-[400px] lg:w-1/4 h-full bg-slate-50 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 lg:flex flex-col py-3 overflow-y-auto scroll-area">
    
    
    <a href="https://vozec.fr/articles/">
      <h2 class="font-bold mb-5 py-1 pl-12 pr-3 md:px-3">Articles</h2>
    </a>
<label class="mb-2 block px-2">
  <span></span>
  <input type="text" placeholder="Search articles" class="searchInput bg-white rounded px-2 py-1 w-full border" />
</label>
<script>
  const searchElt = document.querySelector('.searchInput')
  if (searchElt) {
    searchElt.addEventListener('input', evt => {
      const value = evt.target.value || '';

      const articles = document.querySelectorAll('.article')
      if (!value) {
        articles.forEach(article => article.classList.remove('hidden'))
      } else {
        articles.forEach(article => article.classList.add('hidden'))
        Array.from(articles).filter(article => {
          const title = article.querySelector('h3')
          if (!title) return false;

          return title.textContent.toLowerCase().includes(value.toLowerCase())
        }).forEach(article => article.classList.remove('hidden'))
      }
    })
  }
</script>
<div class="space-y-2.5">
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/attaque-oracle-padding-aes_ecb/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Présentation de l&#39;attaque &#39;Padding Oracle&#39; sur de l&#39;AES ECB</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction L&rsquo;AES (&ldquo;Advanced Encryption Standard&rdquo;) est un chiffrement par blocs utilisé de nos jours dans la sécurité informatique. Il repose sur le chiffrement d&rsquo;information découpé en plusieurs blocs et le chiffrement de ces blocs peuvent être fait de plusieurs manières selon la configuration du système. Ainsi il en existe plusieurs modes :
ECB CBC CFB OFB CTR CTS &hellip; Aujourd’hui, nous allons aborder une attaque présente sur l&rsquo;AES en mode ECB .
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/anti-cheat-ctf/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Lutter contre la triche en CTF ?</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Dans cet article , je vais présenter les différentes possibilités pour empêcher la triche en compétition et notamment sur des ctf basés sur CTFd . Je précise que ces techniques permettent de mettre en avant les comptes suspects. Il y a plusieurs façons de cocher les cases d&rsquo;un tricheurs si on suis ces critères bêtement et inversement , il y a malheureusement plusieurs façon de contourner ces protections.
Tous ce que je vais expliquer ici sert donc à mettre en avant un compte ou une équipe afin que des admins procède à une vérification manuelle et agissent en conséquence.
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/attaque-bit-flipping-aes_cbc/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Présentation de l&#39;attaque &#39;Bit Flipping&#39; sur de l&#39;AES CBC</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction L&rsquo;AES (&ldquo;Advanced Encryption Standard&rdquo;) est un chiffrement par blocs utilisé de nos jours dans la sécurité informatique. Il repose sur le chiffrement d&rsquo;information découpé en plusieurs blocs et le chiffrement de ces blocs peuvent être fait de plusieurs manières selon la configuration du système . Ainsi il en existe plusieurs modes :
ECB CBC CFB OFB CTR CTS &hellip; Aujourd&rsquo;hui , nous allons aborder une attaque présente sur l&rsquo;AES en mode CBC .
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/python-from-0/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Python from 0</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Les Variables : Il existe des centaines de type de variables mais les principales sont :
Les String (&lsquo;chaine de caractère&rsquo;) :
msg = &#34;Hello World&#34; Les Int (&lsquo;Integers&rsquo;) : Ce sont les nombres entiers
nbr = 2021 * 4 Les Float : Les nombres décimaux
flt = 3.14159265359 Les List : Les listes contiennent des &lsquo;object&rsquo; de tous types:
lst = [&#34;Hello World&#34;,5,3.14,[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;],9] Les Dict &lsquo;Dictionnaires&rsquo; : Associent à un objet , une valeur :
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/analyse-telegram-stealer/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Malware Analysis d&#39;une Virus Télégram</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Je suis tombé sur ce .exe et j&rsquo;ai décidé de l&rsquo;analyser. Voici le fichier : ici Attention à ne pas l&rsquo;executer !
Commencement Comme le dernier analyse de malware , j&rsquo;ai regardé sur Dnspy si le code était caché . A notre plus grande surprise il ne l&rsquo;était pas ! Regardons de quoi est composé notre payload :
La Première chose qui saute aux yeux et que c&rsquo;est un virus.
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/pourquoi-vous-devez-s%C3%A9curiser-vos-dll-2/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Execution de ShellCode grâce au Dll Hidjacking</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Nous avons déjà parlé du DLL Hidjacking dans un article précédent. Aujourd’hui, nous allons aller plus loin. Nous avions détourné la Bibliothèque LeafXnet.dll qui est des plus utilisée pour faire des requêtes web. Nous aurions pu utiliser une autre, comme Newtonsoft.Json.dll ou encore Colorful.Console.dll . Voici le résultat que nous avions la dernière fois :
Nous récupérions juste les requêtes pour les écrire dans un fichier texte.
Petit Rappel Le Dll Hidjacking consiste à modifier une bibliothèque appelée par un programme et ainsi ajouter du code exécuter.
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/analyse-fake-cheat-valorant/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Malware Analysis d&#39;un Fake Cheat</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Je suis tombé sur ce soi-disant Cheat Valorant et j&rsquo;ai décidé de l&rsquo;analyser. Voici le fichier : ici Attention à ne pas l&rsquo;executer !
Commencement Après avoir télécharger le .exe , je lui supprime tous de suite son extension .exe pour éviter de le lancer par erreur en cliquant dessus .
Je lance DetectItEasy et je me rends compte qu&rsquo;il est compilé en .Net
Je vais donc utiliser Dnspy pour explorer le code .
        </div>
      </a>
      
      <a class="article block px-3 py-4  bg-slate-900 dark:bg-slate-700 text-slate-50 "
        href="/articles/contourner-le-ssl-pinning-sur-android/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Comment contourner le SSL Pinning sur android</h3>
        <div
          class="text-sm  text-slate-400  line-clamp-2">
          Introduction Pour un projet personnel, j&rsquo;ai dû récupérer une requête provenant d&rsquo;une application de mon téléphone. Après de nombreuses recherches j&rsquo;ai trouvé comment faire et j&rsquo;ai compris toutes les méthodes pour y parvenir. La principale difficulté pour récupérer le traffic réseau de votre téléphone est de déchiffré les requêtes https.
HttpS , c&rsquo;est quoi ? &ldquo;HyperText Transfer Protocol Secure&rdquo; est un Protocol qui succède à l&rsquo;http . En effet il reprend l&rsquo;http en y rajoutant une couche de chiffrement comme SSL ou TLS .
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/les-captchas-sont-inutiles-part3/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Comment utiliser l&#39;OCR pour résoudre des captchas</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Dans des articles précédent, nous avons vu comment bypass 2 types de catpcha . Mais peut-on tous les bypass ? La réponse est oui à quelques exceptions près et nous allons voir comment.
Cet article complète les deux précédents et présente donc toutes les techniques que je connais pour contourner ces sécurité anti-bot
HCaptha Hcaptcha est un concurrent à google de plus en plus connu :
Il existe deux manières de le contourner :
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/les-captchas-sont-inutiles-part2/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Comment Isoler un Recaptcha</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Nous avons vu dans un précédent comment bypass les reCAPTCHA Silencieux ; ceux en arrière-plan . Mais comment faire quand ces captchas nécessitent une interaction Humaine à tout prix ? C&rsquo;est ce que nous allons découvrir.
Le problème Dans un captcha Silencieux, il n&rsquo;y pas d&rsquo;interactions entre l&rsquo;utilisateur et le captcha. On peut donc le contourner en simulant des actions identiques au script natif. Par contre, dans un captcha visible.
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/les-captchas-sont-inutiles-part1/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Comment Bypass un Silent Recaptcha V3</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Les Captchas sont partout, ce sont des petits programmes web qui servent à déterminer si leur interlocuteur est un Homme ou un Robot. Ce n&rsquo;est pas très dérangeant pour les gens normaux mais cela devient ennuyeux pour les développeur qui souhaitent faire du scraping web ou juste se connecter à un service depuis le site-Web. Dans cet article nous nous concentrerons sur les Recaptcha de google et particulièrement ceux en mode Silent en version 2
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/pourquoi-votre-wifi-est-vuln%C3%A9rable/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Pourquoi votre wifi est-il vulnérable</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Je rappelle que le piratage d&rsquo;un réseau dont vous n&rsquo;êtes pas le propriétaire ou dont vous n&rsquo;avez pas d&rsquo;accord est strictement illégal. Je ne serais pas responsable des actions que vous ferrez après la lecture des cet article
La sécurité WPA2 (Wi-Fi Protected Access Version 2) est la sécurité la plus courante sur vos routeurs personnels. C&rsquo;est à dire sur votre box internet personnelle. Il est pris en charge depuis 2005 sur Windows XP et il est encore utilisé de nos jours.
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/pourquoi-vous-devez-s%C3%A9curiser-vos-dll/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Pourquoi il faut sécuriser vos DLL P1</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          Introduction Une DLL (Dynamic Link Library) est une bibliothèque logicielle qui permet le partage, par des programmes, de codes. Pour résumer, c&rsquo;est une bibliothèque avec plusieurs fonctions à l&rsquo;intérieur. C&rsquo;est très utile pour ne pas toujours coder la même chose. On code une fois la DLL et on a plus qu&rsquo;a appelé ses fonctions dans tous ses projets. L&rsquo;avantage du C# est qu&rsquo;il existe un grand nombre de bibliothèques, et la plupart sont Open-Source, sur GitHub principalement
        </div>
      </a>
      
      <a class="article block px-3 py-4  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles/comment-reverse-du-.net-facilement/">
        
        
        <h3 class="text-lg font-semibold mb-0.5">Comment Reverse du .Net facilement</h3>
        <div
          class="text-sm  text-slate-500 dark:text-slate-400  line-clamp-2">
          [//]: &lt;&gt; (Created By Vozec 23/10/2021) Nécessaires Ce pack complet pour l&amp;rsquo;obfuscation C# Introduction .Net est un langage assez facile à reverse en général . Grâce à de simples outils comme JetBrain Dotpeek , DnSpy ou Ilspy , on peut facilement débugger , éditer , patcher un assembly sans soucis . La principale difficulté et la multitude de protection qui existe autour du Framework de Microsoft (.Net Framework/Core). Nous allons donc voir quelles sont les principales sécurités et comment les détourner .
        </div>
      </a>
      </div>
    </section>

  <div class="overflow-y-auto h-screen w-full">
    <article class="px-6 py-20 w-full mx-auto prose lg:prose-lg h-fit dark:prose-invert prose-img:mx-auto">

      
      <h1 class="!mb-2">Comment contourner le SSL Pinning sur android</h1>

	  
      <p class="text-sm text-slate-500 !mb-8"> Planted November 4, 2021
		
	  </p>
      

      

      <h2 id="introduction">Introduction</h2>
<p>Pour un projet personnel, j&rsquo;ai dû récupérer une requête provenant d&rsquo;une application de mon téléphone. Après de nombreuses recherches j&rsquo;ai trouvé comment faire et j&rsquo;ai compris toutes les méthodes pour y parvenir.
La principale difficulté pour récupérer le traffic réseau de votre téléphone est de déchiffré les requêtes https.</p>
<h3 id="https--cest-quoi-">Http<strong>S</strong> , c&rsquo;est quoi ?</h3>
<p>&ldquo;HyperText Transfer Protocol Secure&rdquo; est un Protocol qui succède à l&rsquo;http . En effet il reprend l&rsquo;http en y rajoutant une couche de chiffrement comme SSL ou TLS .
<code>Un certificat</code> assure l&rsquo;intégrité de la destination et empêche à un Tier de se plaçant entre votre machine et votre site web pour contrôler votre requête web .</p>
<p>Voici une attaque type de l&rsquo;homme du milieu <code>(&quot;Man in the middle&quot;)</code> :</p>
<p><img src="./img/mitm.png" alt="Alt text">
Un attaquant détourne vos requêtes vers sa machine et peut ainsi contrôler tous ce que vous faites sur le réseau.
C&rsquo;est un attaque courant dans les wifi publique (Mcdo , Starbucks)</p>
<p>Une fois un certificat SSL initialisé, l&rsquo;attaquant ne peut plus rien intercepter :</p>
<p><img src="./img/mitm2.png" alt="Alt text"></p>
<h3 id="quel-est-le-lien-avec-notre-application-">Quel est le lien avec notre application ?</h3>
<p>La plupart des applications utilise les certificats pour sécuriser leur connexion et empêche donc la récupération de leur requête.</p>
<h3 id="comment-récupérer-le-flux-wifi-dun-smartphone-">Comment récupérer le flux wifi d&rsquo;un smartphone ?</h3>
<p>Et oui, avant de vouloir déchiffré <em>HTTPS</em> , il faudrait déjà avoir les <em>HTPP</em> , celles non sécurisées !
On peut utiliser plusieurs logiciels :</p>
<ul>
<li><a href="https://www.telerik.com/download/fiddler"  target="_blank" rel="noopener" >Fiddler</a></li>
<li><a href="https://www.wireshark.org/download.html"  target="_blank" rel="noopener" >Wireshark</a></li>
<li><a href="https://portswigger.net/burp/communitydownload"  target="_blank" rel="noopener" >Burpsuite</a></li>
<li><a href="https://www.charlesproxy.com/download/latest-release/"  target="_blank" rel="noopener" >Charles</a></li>
<li><a href="https://m.apkpure.com/fr/httpcanary-%E2%80%94-http-sniffer-capture-analysis/com.guoshi.httpcanary"  target="_blank" rel="noopener" >HttpCanary</a></li>
</ul>
<p>Personnellement, je vais utiliser fiddler mais le fonctionnement est identiques pour les autres outils.</p>
<p>On doit se rendre dans les options de connexion est activé la connexion à distance.
Tuto pour Fiddler <a href="https://docs.telerik.com/fiddler/configure-fiddler/tasks/configureforandroid"  target="_blank" rel="noopener" >ici</a></p>
<p>Ajoutons ensuite l’IP de notre pc en tant que proxy sur notre smartphone.</p>
<pre tabindex="0"><code>Paramètres &gt; Wifi &gt; Options+ de notre wifi &gt; Proxy :
- Hostname = IP local du pc (192.168.1.X)
- Proxy port = Port utilisé par le logiciel (Fiddler:8888 | Burpsuite:8080)
</code></pre><p>Il faut ensuite installer le certificat du logiciel sur le smartphone. On peut soit exporter le certificat (fichier .cer ou .crt) et l&rsquo;installer en cliquant dessus depuis notre gestionnaire de fichier. Soit directement utilisé l&rsquo;option du sniffer si elle est disponible.</p>
<p>Fiddler : Rendez-vous sur <code>http://ipv4.fiddler:8888/</code> une fois le proxy configuré  et cliquez sur <code>FiddlerRoot Certificate</code>
<img src="./img/fiddler.png" alt="Alt text">
Là vous pouvez cliquer dessus une fois télécharger.
Voici un tuto pour fiddler qui résume bien : <a href="https://www.youtube.com/watch?v=mFJX8ETk2Mc"  target="_blank" rel="noopener" >ici</a></p>
<p>Normalement si tous est bon, vous devriez recevoir les requêtes HTTPS du navigateur.
<img src="./img/https.png" alt="Alt text"></p>
<h3 id="comment-bypass-le-ssl-pining-">Comment bypass le ssl-Pining ?</h3>
<p>On arrive à la partie délicate ; les requêtes https provenant d’applications.
Il existe plusieurs méthodes :</p>
<h3 id="méthode-1-">Méthode 1 :</h3>
<p>La première est la plus courante. Pour faire simple, les application ne font pas confiance aux certificat installés par l&rsquo;utilisateur , <strong>en d&rsquo;autre termes le certificat installé précédemment n&rsquo;est pas considéré comme fiable par les applications .</strong>
La première technique est donc de passé ce certificat en tant que certificat système et non utilisateur. En effet la plupart des applications se base sur les certificats système, ceux de google par exemple.</p>
<p>Pour passer notre certificat précédent (celui de fiddler) en tant que système, <strong>il faut que notre appareil Android soit rooté</strong> .
On supprime celui installé précédent et on va venir le réinstallé avec <a href="https://play.google.com/store/apps/details?id=net.jolivier.cert.Importer"  target="_blank" rel="noopener" >cette application</a> : <em>&ldquo;Root Certificat Manager&rdquo;</em>
Une fois fais , après un redémarrage , on devrait apercevoir les requêtes déchiffrées .</p>
<p>Si vous n&rsquo;êtes pas équipé d&rsquo;un téléphone root , peut être avez-vous un vieux téléphone qui ne sert plus .
Dans les anciens smartphone <strong>(version d’Android &lt; 5)</strong> , les applications acceptent les certificat utilisateur . On peut donc se passer de l&rsquo;étape précédente et directement récupérer le Traffic.
<strong>Attention</strong> il est possible que l&rsquo;application refuse votre version d’Android trop ancienne. J&rsquo;explique comment contourner cette vérification dans la suite de l&rsquo;article.</p>
<h3 id="méthode-2-">Méthode 2 :</h3>
<p>Si la technique précédent n&rsquo;a pas marché, on va devoir faire l’inverse. Au lieu de passer notre certificat en tant que certificat système : on va forcer l&rsquo;application à autoriser les certificats utilisateurs.</p>
<p>La première étape est de récupéré l&rsquo;<code>apk</code> de notre application ainsi que tu logiciel <strong><a href="https://ibotpeaches.github.io/Apktool/"  target="_blank" rel="noopener" >APKTOOl</a></strong></p>
<p>On va décompiler notre apk , allez dans votre invite de commande (cmd/powershell) et rendez-vous dans votre dossier apktool , vous y aurez placer votre apk dans ce même dossier au préalable.</p>
<p>On a :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d application.apk
</span></span></code></pre></div><p><img src="./img/apktool.png" alt="Alt text"></p>
<p>Un dossier au nom de notre application c&rsquo;est créé .</p>
<p>Nous devons rajoutez ce code dans le fichier <code>AndroidManifest.xml</code> aprés <code>&lt;application</code>:</p>
<pre tabindex="0"><code>android:networkSecurityConfig=&#34;@xml/network_security_config&#34;
</code></pre><p>et</p>
<pre tabindex="0"><code>android:extractNativeLibs=&#34;true&#34;
</code></pre><p><code>OU mettre 'true' à la place de 'false' si 'extractNativeLibs' est déja présent</code></p>
<p>De cette manière :
<img src="./img/apktool2.png" alt="Alt text"></p>
<p>Puis on doit créer/modifier un fichier dans le dossier <code>res/xml</code> du nom de <code>network_security_config.xml</code>
Voici son contenu :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;network-security-config&gt;</span>  
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;base-config&gt;</span>  
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;trust-anchors&gt;</span>  
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">&lt;!-- Trust preinstalled CAs --&gt;</span>  
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;certificates</span> <span style="color:#50fa7b">src=</span><span style="color:#f1fa8c">&#34;system&#34;</span> <span style="color:#ff79c6">/&gt;</span>  
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">&lt;!-- Additionally trust user added CAs --&gt;</span>  
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;certificates</span> <span style="color:#50fa7b">src=</span><span style="color:#f1fa8c">&#34;user&#34;</span> <span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">&lt;/trust-anchors&gt;</span>  
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;/base-config&gt;</span>  
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">&lt;/network-security-config&gt;</span>
</span></span></code></pre></div><p>A vous d&rsquo;adapter si le fichier existe déjà , <code>&lt;certificates src=&quot;user&quot; /&gt;</code> est la ligne important dans les balises <code>trust-anchors</code> .
Vous pouvez aussi ajouter cette ligne par exemple :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;certificates</span> <span style="color:#50fa7b">src=</span><span style="color:#f1fa8c">&#34;@raw/fiddler&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span></code></pre></div><p>Et ensuite crée un dossier res/raw et ajouter le certificat fiddler.cer
<img src="./img/apktool3.png" alt="Alt text"></p>
<hr>
<h6 id="comment-changer-la-version-minimale-de-lapplication">Comment changer la version minimale de l&rsquo;application</h6>
<p>Il est possible que votre application refuse de s&rsquo;exécuter sur votre téléphone s’il est trop vieux.
Pour changer la version minimale, modifiez la valeur de <code>minSdkVersion</code> dans le fichier <strong>apktool.yml</strong>
23 correspond à Android 6.0
Tous est résumé <a href="https://developer.android.com/studio/releases/platforms"  target="_blank" rel="noopener" >ici</a></p>
<hr>
<p>Maintenant que nous avons modifié notre APK , il faut le recompiler :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool b nomdudossier -o fichierdesortie.apk
</span></span></code></pre></div><p>Vous devriez avoir un fichier apk qui vient de se créer :
<img src="./img/apktool4.png" alt="Alt text"></p>
<p>Enfin pour installer notre nouvelle apk , nous devons le signer .
Pour installer une application, Android doit vérifier la provenance et c&rsquo;est pour cela que nous devons appliqué une signature à notre nouvelle application patchée .</p>
<p>On peut utiliser <a href="https://github.com/Jamling/jarsigner"  target="_blank" rel="noopener" >jarsigner</a> ou <a href="https://developer.android.com/studio/command-line/apksigner"  target="_blank" rel="noopener" >apksigner</a>
Je préfère utiliser apksigner car il est plus récent et supporte les dernières version et algorithmes de signatures.</p>
<p>On génère d&rsquo;abord un keystore</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>keytool -genkey -v -keystore key.keystore -alias app -keyalg RSA -keysize <span style="color:#bd93f9">2048</span> -validity <span style="color:#bd93f9">10000</span>
</span></span></code></pre></div><p>On doit ensuite aligner notre .apk</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>zipalign -c <span style="color:#bd93f9">4</span> application.modifie.apk
</span></span></code></pre></div><p>Enfin, on signe l&rsquo;apk avec notre keystore :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apksigner sign sign -v --out final.apk --ks key.keystore --ks-key-alias app application.modifie.apk
</span></span><span style="display:flex;"><span>apksigner verify final.apk
</span></span></code></pre></div><p>Et voilà ! Vous pouvez installer final.apk sans soucis.</p>
<h3 id="méthode-3-">Méthode 3 :</h3>
<p>On va ici s&rsquo;intéresse au Hooking *(Root non requis) *. On va à nouveau modifier l&rsquo;application mais cette fois avec <strong><a href="https://github.com/frida"  target="_blank" rel="noopener" >le Framework Frida</a></strong> . Frida va injecter du code dans notre apk et une fois installé, quand celle-ci sera lancé, elle <strong>se connectera à un serveur sur notre pc et nous pourrons désactiver le sslpining de l&rsquo;application souhaitée</strong></p>
<p>La première étape est de décompiler l&rsquo;apk comme dans la méthode 2 :
On a :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d application.apk
</span></span></code></pre></div><p>Il faut télécharger la bonne version de <a href="https://github.com/frida/frida/releases/tag/15.1.9"  target="_blank" rel="noopener" >frida-gadget</a></p>
<p>Renommer la librairie en : <code>libfrida-gadget.so</code></p>
<p>Et placer la dans le dossier lib/architecture:
<code>exemple : /lib/arm64-v8a/libfrida-gadget.so</code></p>
<p>Maintenant, on doit modifier l&rsquo;application pour qu&rsquo;elle lance Frida au démarrage. Nous l&rsquo;avons ajouter dans l&rsquo;app , maintenant nous devons l&rsquo;activer .</p>
<p>Voici un schéma du fonctionnement de Frida :
<img src="./img/resumefrida.png" alt="Alt text"></p>
<p>On doit installer Frida :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>python -m pip install Frida
</span></span><span style="display:flex;"><span>python -m pip install objection
</span></span><span style="display:flex;"><span>python -m pip install frida-tools
</span></span><span style="display:flex;"><span>ou
</span></span><span style="display:flex;"><span>pip install Frida
</span></span><span style="display:flex;"><span>pip install objection
</span></span><span style="display:flex;"><span>pip install frida-tools
</span></span></code></pre></div><h6 id="méthode-1--modifier-la-librairie-de-base-et-y-ajouter-celles-ce-frida">Méthode 1 : Modifier la librairie de base et y ajouter celles ce frida</h6>
<p>On peut injecter avec ce script notre librairie Frida dans celle qui existe déjà :</p>
<p>(lief doit être installé : <code>python3 -m pip install lief</code> )</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> lief
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libnative <span style="color:#ff79c6">=</span> lief<span style="color:#ff79c6">.</span>parse(<span style="color:#f1fa8c">&#34;target/lib/arm64-v8a/libconscrypt_jni.so&#34;</span>)
</span></span><span style="display:flex;"><span>libnative<span style="color:#ff79c6">.</span>add_library(<span style="color:#f1fa8c">&#34;libfrida-gadget.so&#34;</span>) <span style="color:#6272a4"># Injection!</span>
</span></span><span style="display:flex;"><span>libnative<span style="color:#ff79c6">.</span>write(<span style="color:#f1fa8c">&#34;target/lib/arm64-v8a/libconscrypt_jni.so&#34;</span>)
</span></span></code></pre></div><p><em>(Vous devez remplacer libconscrypt_jni.so par le nom de la Lib d&rsquo;origine ; Pour moi : libconscrypt_jni.so)</em></p>
<p>On execute:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 inject-gadget.py
</span></span></code></pre></div><p>Sur linux on peut vérifier que ça a marché :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>readelf -d target/lib/arm64-v8a/libfromapk.so
</span></span></code></pre></div><p><img src="./img/readelf.png" alt="Alt text"></p>
<h6 id="méthode-2--modifier-le-code-smali-pour-charger-notre-librairie">Méthode 2 : Modifier le code Smali pour charger notre librairie.</h6>
<p>Cette fois, on cherche à injecter du code <strong>SMALI</strong> dans notre app.
Voici le code a injecter ; il permet de charger notre librairie :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">const</span><span style="color:#ff79c6">-</span>string v0<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;frida-gadget&#34;</span>
</span></span><span style="display:flex;"><span>invoke<span style="color:#ff79c6">-</span><span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#ff79c6">{</span>v0<span style="color:#ff79c6">},</span> Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>System<span style="color:#ff79c6">;-&gt;</span>loadLibrary<span style="color:#ff79c6">(</span>Ljava<span style="color:#ff79c6">/</span>lang<span style="color:#ff79c6">/</span>String<span style="color:#ff79c6">;)</span>V
</span></span></code></pre></div><p>Pour trouver ou le mettre, on cherche un fichier smali avec : <code>MainActivity</code>
On peut chercher dans <em>AndroidManifest.xml</em> dans les tags <code>&lt;application</code> et <code>&lt;activity</code></p>
<p>Finalement :
<img src="./img/patchfrida.png" alt="Alt text"></p>
<h5 id="_important_"><em>Important</em></h5>
<p>Il ne faut pas oublier de mettre <code>android:extractNativeLibs</code> sur <strong>true</strong> si elle est sur false sinon il faut rajouter <code>android:extractNativeLibs=&quot;true&quot;</code> après <code>&lt;application </code>
*(Comme dans la méthode 2) *</p>
<p>Il faut aussi ajouter dans le même fichier : <code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</code> dans les premières lignes du fichier</p>
<hr>
<p>Cette étape de patch peut être automatisée avec <a href="https://github.com/badadaf/apkpatcher"  target="_blank" rel="noopener" >ce tool</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apkpatcher -a application.apk
</span></span></code></pre></div><p>On peut aussi utiliser <code>Objection</code> pour patcher l&rsquo;apk : Voici une très bonne vidéo : <a href="https://www.youtube.com/watch?v=mstW4dWokF8"  target="_blank" rel="noopener" >ici</a></p>
<p>(Je préfère le faire à la main car je sais ce que je fais et je suis sûr de ne pas avoir d&rsquo;erreur bêtes)</p>
<p>Quel que soit la méthode , <strong>il faut recompiler et re signer notre apk</strong> .
On suivra les mêmes étapes que dans la <strong>méthode 2</strong></p>
<h6 id="dernière-étape-">Dernière étape !</h6>
<p>Il faut maintenant installer l&rsquo;apk et activer Frida, injecté dans l&rsquo;application.</p>
<p>Pour ce faire on va utiliser ADB. Il faut activer dans les options développer le débogage et l&rsquo;installation d&rsquo;application via USB  :
<img src="./img/adb.jpg" alt="Alt text"></p>
<p>On doit brancher son téléphone au pc et télécharger le pack de développement <a href="https://androidsdkmanager.azurewebsites.net/Platformtools"  target="_blank" rel="noopener" >ADB</a> <a href="https://dl.google.com/android/repository/platform-tools-latest-windows.zip"  target="_blank" rel="noopener" >(autre lien)</a> et <a href="https://adbdriver.com/downloads/"  target="_blank" rel="noopener" >ses drivers</a></p>
<p>Une fois le téléphone branché et ADB téléchargé, on se rend dans le dossier de adb.exe avec cmd et on vérifie qu&rsquo;on est connecté à notre appareil :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adb devices
</span></span></code></pre></div><p>Normalement, on devrait voir notre téléphone.</p>
<p>Là, on peut installer l&rsquo;apk <em>(Il doit être dans le dossier de adb.exe)</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adb install -r application.modifie.apk
</span></span></code></pre></div><p>Une fois installé, vous pouvez naviguer dans l&rsquo;application quelques secondes et explorer le maximum d’options, Le but est que la fonction que nous avons modifiée plus haut soit activé et que donc frida-gadget soit lancé. Normalement dès qu&rsquo;il se lance, l&rsquo;application se bloque.</p>
<p>A ce moment on peut faire :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>frida-ps -U
</span></span></code></pre></div><p>On devrait avoir ca : <img src="./img/frida2.png" alt="Alt text">
Finalement pour se connecter au serveur :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>frida-trace -U Gadget
</span></span></code></pre></div><p>On peut télécharger ce script : <a href="./files/fridascript.js" >fridascript.js</a></p>
<p>Et enfin on désactive le ssl pinning avec cette commande :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>frida -f fridascript.js -U Gadget
</span></span></code></pre></div><h3 id="patch">Patch</h3>
<p>Dans certain cas rare, l&rsquo;application vérifie le hash du certificat.
Il faut donc supprimer cette vérification pour que notre certificat soit accepté.
Voici un exemple de code qui empêche la bonne exécution de notre code :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">k</span><span style="color:#ff79c6">(</span>X509TrustManagerExtensions x509TrustManagerExtensions<span style="color:#ff79c6">,</span> HttpsURLConnection httpsURLConnection<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>       HashSet hashSet <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashSet<span style="color:#ff79c6">(</span>NetworkConstants<span style="color:#ff79c6">.</span><span style="color:#50fa7b">d</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>       HashSet hashSet2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashSet<span style="color:#ff79c6">(</span>NetworkConstants<span style="color:#ff79c6">.</span><span style="color:#50fa7b">e</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>       HashSet hashSet3 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashSet<span style="color:#ff79c6">(</span>NetworkConstants<span style="color:#ff79c6">.</span><span style="color:#50fa7b">f</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>           MessageDigest instance <span style="color:#ff79c6">=</span> MessageDigest<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getInstance</span><span style="color:#ff79c6">(</span>MessageDigestAlgorithms<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SHA_256</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>           String str <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#8be9fd">boolean</span> z <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#8be9fd">boolean</span> z2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#8be9fd">boolean</span> z3 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span>X509Certificate next <span style="color:#ff79c6">:</span> h<span style="color:#ff79c6">(</span>x509TrustManagerExtensions<span style="color:#ff79c6">,</span> httpsURLConnection<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>               <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> encoded <span style="color:#ff79c6">=</span> next<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getPublicKey</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getEncoded</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>               instance<span style="color:#ff79c6">.</span><span style="color:#50fa7b">update</span><span style="color:#ff79c6">(</span>encoded<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> encoded<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>               String encodeToString <span style="color:#ff79c6">=</span> Base64<span style="color:#ff79c6">.</span><span style="color:#50fa7b">encodeToString</span><span style="color:#ff79c6">(</span>instance<span style="color:#ff79c6">.</span><span style="color:#50fa7b">digest</span><span style="color:#ff79c6">(),</span> 2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>               str <span style="color:#ff79c6">=</span> str <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;    sha256/&#34;</span> <span style="color:#ff79c6">+</span> encodeToString <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34; : &#34;</span> <span style="color:#ff79c6">+</span> next<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSubjectDN</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> StringUtils<span style="color:#ff79c6">.</span><span style="color:#50fa7b">LF</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>hashSet2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">contains</span><span style="color:#ff79c6">(</span>encodeToString<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                   z <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>hashSet<span style="color:#ff79c6">.</span><span style="color:#50fa7b">contains</span><span style="color:#ff79c6">(</span>encodeToString<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                   z2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>hashSet3<span style="color:#ff79c6">.</span><span style="color:#50fa7b">contains</span><span style="color:#ff79c6">(</span>encodeToString<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                   z3 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">return</span> z <span style="color:#ff79c6">&amp;&amp;</span> z2 <span style="color:#ff79c6">&amp;&amp;</span> z3<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>NoSuchAlgorithmException e2<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> SSLException<span style="color:#ff79c6">(</span>e2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>On va donc modifier le code smali pour avoir une fonction qui renvoie <code>True</code> à chaque appel .
Comme ceci :</p>
<pre tabindex="0"><code>const/4 v9, 0x1
move p2, v9
return p2
</code></pre><p>(code : <em>return true;</em>)
pour avoir ce code java :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">k</span><span style="color:#ff79c6">(</span>X509TrustManagerExtensions x509TrustManagerExtensions<span style="color:#ff79c6">,</span> HttpsURLConnection httpsURLConnection<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div>
    </article>
  </div>

</div>


  </div>
<script type="text/javascript" src="/main.js" defer></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3EGPCQCHEK"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-3EGPCQCHEK', { 'anonymize_ip': false });
}
</script>

</body>

</html>