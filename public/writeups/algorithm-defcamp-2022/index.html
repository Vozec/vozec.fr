<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.ico">

  <title>
    Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR]  - Vozec&#39;s Blog
  </title>

  <meta name="description" content="Algorithm | D-CTF 2022" />
  <meta name="keywords" content="tuto,reverse,howto,ctf,DefCamp,ctftime,Algorithm,crypto,bypass" />
  <meta name="generator" content="Hugo 0.105.0">

  <link rel="stylesheet" href="https://vozec.fr/css/main.css" />

  
  

  <meta property="og:title" content="Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR] " />
<meta property="og:description" content="Algorithm | D-CTF 2022" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vozec.fr/writeups/algorithm-defcamp-2022/" /><meta property="og:image" content="https://vozec.fr/vozec.png"/><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-02-12T12:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-12T12:00:00+00:00" />



  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://vozec.fr/vozec.png"/>

<meta name="twitter:title" content="Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR] "/>
<meta name="twitter:description" content="Algorithm | D-CTF 2022"/>


  <meta itemprop="name" content="Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR] ">
<meta itemprop="description" content="Algorithm | D-CTF 2022"><meta itemprop="datePublished" content="2022-02-12T12:00:00+00:00" />
<meta itemprop="dateModified" content="2022-02-12T12:00:00+00:00" />
<meta itemprop="wordCount" content="1299"><meta itemprop="image" content="https://vozec.fr/vozec.png"/>
<meta itemprop="keywords" content="pwn,tuto,writeup," />

  <meta itemprop="name" content="Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR] ">
<meta itemprop="description" content="Algorithm | D-CTF 2022"><meta itemprop="datePublished" content="2022-02-12T12:00:00+00:00" />
<meta itemprop="dateModified" content="2022-02-12T12:00:00+00:00" />
<meta itemprop="wordCount" content="1299"><meta itemprop="image" content="https://vozec.fr/vozec.png"/>
<meta itemprop="keywords" content="pwn,tuto,writeup," />
</head><body class="flex relative h-full min-h-screen"><aside
  class="will-change-transform transform transition-transform -translate-x-full absolute top-0 left-0 md:relative md:translate-x-0 w-3/4 md:w-60 h-full min-h-screen p-3 bg-slate-50 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col gap-2.5 z-20 sidebar">
  <p class="font-bold mb-5 flex items-center gap-2">
    <button aria-label="Close sidebar"
      class="md:hidden menu-trigger-close p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-6 w-6" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg></button>
    <a href="https://vozec.fr/" class="px-2">
      <span>Vozec&#39;s Blog</span>
    </a>
    <button aria-label="Toggle dark mode"
      class="dark-mode-toggle p-2 rounded border dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700"><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <circle cx="12" cy="12" r="4" />
  <path d="M3 12h1M12 3v1M20 12h1M12 20v1M5.6 5.6l.7 .7M18.4 5.6l-.7 .7M17.7 17.7l.7 .7M6.3 17.7l-.7 .7" />
</svg></button>
  </p>

  
  <ul class="list-none flex flex-col gap-1">
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/" >
        <span>Home</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>C͟o͟n͟t͟e͟n͟t͟ ✒️</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/articles" >
        <span> 〰️ Articles</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/writeups" >
        <span> 〰️ Writeups</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>F͟r͟o͟m͟ 0 T͟o͟ C͟r͟y͟p͟t͟o͟ 🔐</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-rsa" >
        <span> 〰️ Rsa Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-aes" >
        <span> 〰️ Aes Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/crypto-other" >
        <span> 〰️ Other Courses</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  text-slate-400 font-semibold pb-0 pl-1 border-b cursor-default pointer-events-none "
        href="#" >
        <span>A͟b͟o͟u͟t͟ M͟e͟👀</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="/contact" >
        <span> 〰️ Contact Me</span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm flex items-center justify-between  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://flag-poisoning.fr"  target="_blank"
        rel="noopener" >
        <span> 〰️ My Ctf Team </span>
        
        <span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <path d="M11 7h-5a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-5" />
  <line x1="10" y1="14" x2="20" y2="4" />
  <polyline points="15 4 20 4 20 9" />
</svg></span>
        
      </a>
    </li>
    
  </ul>

  <div class="flex-1"></div>

  

  <ul class="list-none flex flex-wrap justify-center gap-1 pt-2 border-t border-slate-200 dark:border-slate-600">
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://twitter.com/Vozec1" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Twitter</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path
    d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://github.com/Vozec" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">GitHub</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path
    d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://www.linkedin.com/in/arthur-deloffre-844b7a221/" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">LinkedIn</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
  <rect x="2" y="9" width="4" height="12" />
  <circle cx="4" cy="4" r="2" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="mailto:arthursd444@gmail.com" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Email</span>
        
        <span><svg class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <rect x="3" y="5" width="18" height="14" rx="2" />
  <polyline points="3 7 12 13 21 7" />
</svg></span>
        
      </a>
    </li>
    
    <li>
      <a class="px-2 py-1.5 rounded-md text-sm block text-slate-800 dark:text-slate-50  hover:bg-slate-200 dark:hover:bg-slate-700 "
        href="https://www.instagram.com/arthur_dlfr/" target="_blank" rel="noopener noreferrer">
        <span class="sr-only">Instagram</span>
        
        <span><svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
  stroke-linecap="round" stroke-linejoin="round">
  <rect x="2" y="2" width="20" height="20" rx="5" ry="5" />
  <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
  <line x1="17.5" y1="6.5" x2="17.51" y2="6.5" />
</svg></span>
        
      </a>
    </li>
    
  </ul>
</aside>

<div
  class="fixed bg-slate-700 bg-opacity-5 transition duration-200 ease-in-out inset-0 z-10 pointer-events-auto md:hidden left-0 top-0 w-full h-full hidden menu-overlay">
</div>

<button aria-label="Toggle Sidebar"
  class="md:hidden absolute top-3 left-3 z-10 menu-trigger p-1 rounded text-slate-800 dark:text-slate-50 hover:bg-slate-100"><svg class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
  fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" />
  <line x1="4" y1="6" x2="20" y2="6" />
  <line x1="4" y1="12" x2="20" y2="12" />
  <line x1="4" y1="18" x2="16" y2="18" />
</svg></button>
<div class="flex-1">




<div class="flex max-h-screen relative overflow-y-auto h-full">
  
  <article class="px-6 py-20 w-full mx-auto prose lg:prose-lg dark:prose-invert h-fit prose-img:mx-auto">
    
    <a href="https://vozec.fr/writeups/" class="!no-underline !text-slate-500 !mb-2 !inline-block !font-normal !text-sm hover:!text-slate-700 dark:hover:!text-slate-400">← Back to list</a>

    
    <h1 class="!mb-2">Algorithm | DefCamp 2022 | Catégorie Crypto | [Vozec/FR] </h1>
    
    <p class="text-sm text-slate-500 !mb-8">February 12, 2022</p>
    

    

    <h2 id="fichiers">Fichier(s)</h2>
<ul>
<li><a href="./files/chall.py" >Chall.py</a></li>
<li><a href="./files/flag_enc.txt" >Flag_enc</a></li>
</ul>
<h2 id="nécessaires">Nécessaires</h2>
<ul>
<li>Python3</li>
</ul>
<h2 id="flag">Flag</h2>
<pre tabindex="0"><code>CTF{267a4401ea64e7167168969743dcc708399e3823d40e4ae37c78d675e281cb14}
</code></pre><h2 id="description">Description</h2>
<p>Hello friends. Just a regular algorithm
Flag format: CTF{sha256(message_decrypt)}</p>
<h2 id="solution-détaillée">Solution détaillée</h2>
<p>Dans <code>Flag_enc</code> on retrouve le flag chiffré : <code>242712673639869973827786401934639193473972235217215301</code></p>
<p>Analysons le chiffrement dans <code>chall.py</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>flag <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39; [test]&#39;</span>
</span></span><span style="display:flex;"><span>hflag <span style="color:#ff79c6">=</span> flag<span style="color:#ff79c6">.</span>encode(<span style="color:#f1fa8c">&#39;hex&#39;</span>)
</span></span><span style="display:flex;"><span>iflag <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(hflag[<span style="color:#bd93f9">2</span>:], <span style="color:#bd93f9">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">polinom</span>(n, m):
</span></span><span style="display:flex;"><span>   i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>   z <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>   s <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">while</span> n <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>   	<span style="color:#ff79c6">if</span> n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>   		z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">2</span> <span style="color:#ff79c6">-</span> (n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">4</span>))
</span></span><span style="display:flex;"><span>   	<span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>   		z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>   	n <span style="color:#ff79c6">=</span> (n <span style="color:#ff79c6">-</span> z[i])<span style="color:#ff79c6">/</span><span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>   	i <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>   z <span style="color:#ff79c6">=</span> z[::<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>   l <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(z)
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, l):
</span></span><span style="display:flex;"><span>       s <span style="color:#ff79c6">+=</span> z[i] <span style="color:#ff79c6">*</span> m <span style="color:#ff79c6">**</span> (l <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">-</span> i)
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">return</span> s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>r <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">while</span> i <span style="color:#ff79c6">&lt;</span> <span style="color:#8be9fd;font-style:italic">len</span>(<span style="color:#8be9fd;font-style:italic">str</span>(iflag)):
</span></span><span style="display:flex;"><span>   d <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(iflag)[i:i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>]
</span></span><span style="display:flex;"><span>   nf <span style="color:#ff79c6">=</span> polinom(<span style="color:#8be9fd;font-style:italic">int</span>(d), <span style="color:#bd93f9">3</span>)
</span></span><span style="display:flex;"><span>   r <span style="color:#ff79c6">+=</span> <span style="color:#8be9fd;font-style:italic">str</span>(nf)
</span></span><span style="display:flex;"><span>   i <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span> r
</span></span></code></pre></div><p>Le flag est d&rsquo;abord encodé en <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_hexad%C3%A9cimal"  target="_blank" rel="noopener" >Hexadécimal</a> , puis , convertit en nombre .</p>
<p>Une chose qui saute aux yeux et que c&rsquo;est un chiffrement par block. Les charactères sont donc chiffrés par <em>block de 2</em>.
Ici chaque block est stocké dans la variable <strong>d</strong></p>
<p>Puis le block est passé dans la fonction <strong>polinom</strong> et le résultat est concaténé a <strong>r</strong> , la variable renvoyé à la fin du script.</p>
<p>La fonction <strong>polinom</strong> semble complexe et l&rsquo;approche suivante va permettre de ne pas s&rsquo;en occuper beaucoup. Nous n&rsquo;allons donc pas tenter de l’inverser.</p>
<p>J&rsquo;ai quand même simplifié la fonction un tout petit peu en supprimant le paramètre <strong>m</strong> qui reste constant :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">polinom</span>(n):
</span></span><span style="display:flex;"><span>	i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	z <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>	s <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">while</span> n <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">if</span> n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>			z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">2</span> <span style="color:#ff79c6">-</span> (n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">4</span>))
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>			z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>		n <span style="color:#ff79c6">=</span> (n <span style="color:#ff79c6">-</span> z[i])<span style="color:#ff79c6">/</span><span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>		i <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>	z <span style="color:#ff79c6">=</span> z[::<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>	l <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(z)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, l):
</span></span><span style="display:flex;"><span>		 s <span style="color:#ff79c6">+=</span> z[i] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">**</span> (l <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">-</span> i)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> s
</span></span></code></pre></div><p>Une chose notable est que la fonction polinom est statique, elle prend une entrée et renvoie une sortie ; aucun autre paramètre influe sur le résultat . Ainsi, chaque entrée aura sa sortie correspondante.</p>
<p>On peut donc générer un mapping de tous les blocks de 2 nombres avec leurs résultats correspondants :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">mapping</span>():
</span></span><span style="display:flex;"><span>	mapping <span style="color:#ff79c6">=</span> {}
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>				block <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(i)<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(j)
</span></span><span style="display:flex;"><span>				val <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(polinom(<span style="color:#8be9fd;font-style:italic">int</span>(block)))
</span></span><span style="display:flex;"><span>				mapping[<span style="color:#8be9fd;font-style:italic">str</span>(block)]<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">str</span>(val)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> mapping
</span></span></code></pre></div><p>Résultat :</p>
<pre tabindex="0"><code>{&#39;00&#39;: &#39;0&#39;, &#39;01&#39;: &#39;1&#39;, &#39;02&#39;: &#39;3&#39;, &#39;03&#39;: &#39;8&#39;, &#39;04&#39;: &#39;9&#39;, &#39;05&#39;: &#39;10&#39;, &#39;06&#39;: &#39;24&#39;, &#39;07&#39;: &#39;26&#39;, &#39;08&#39;: &#39;27&#39;, &#39;09&#39;: &#39;28&#39;, &#39;10&#39;: &#39;30&#39;, &#39;11&#39;: &#39;71&#39;, &#39;12&#39;: &#39;72&#39;, &#39;13&#39;: &#39;73&#39;, &#39;14&#39;: &#39;78&#39;, &#39;15&#39;: &#39;80&#39;, &#39;16&#39;: &#39;81&#39;, &#39;17&#39;: &#39;82&#39;, &#39;18&#39;: &#39;84&#39;, &#39;19&#39;: &#39;89&#39;, &#39;20&#39;: &#39;90&#39;, &#39;21&#39;: &#39;91&#39;, &#39;22&#39;: &#39;213&#39;, &#39;23&#39;: &#39;215&#39;, &#39;24&#39;: &#39;216&#39;, &#39;25&#39;: &#39;217&#39;, &#39;26&#39;: &#39;219&#39;, &#39;27&#39;: &#39;233&#39;, &#39;28&#39;: &#39;234&#39;, &#39;29&#39;: &#39;235&#39;, &#39;30&#39;: &#39;240&#39;, &#39;31&#39;: &#39;242&#39;, &#39;32&#39;: &#39;243&#39;, &#39;33&#39;: &#39;244&#39;, &#39;34&#39;: &#39;246&#39;, &#39;35&#39;: &#39;251&#39;, &#39;36&#39;: &#39;252&#39;, &#39;37&#39;: &#39;253&#39;, &#39;38&#39;: &#39;267&#39;, &#39;39&#39;: &#39;269&#39;, &#39;40&#39;: &#39;270&#39;, &#39;41&#39;: &#39;271&#39;, &#39;42&#39;: &#39;273&#39;, &#39;43&#39;: &#39;638&#39;, &#39;44&#39;: &#39;639&#39;, &#39;45&#39;: &#39;640&#39;, &#39;46&#39;: &#39;645&#39;, &#39;47&#39;: &#39;647&#39;, &#39;48&#39;: &#39;648&#39;, &#39;49&#39;: &#39;649&#39;, &#39;50&#39;: &#39;651&#39;, &#39;51&#39;: &#39;656&#39;, &#39;52&#39;: &#39;657&#39;, &#39;53&#39;: &#39;658&#39;, &#39;54&#39;: &#39;699&#39;, &#39;55&#39;: &#39;701&#39;, &#39;56&#39;: &#39;702&#39;, &#39;57&#39;: &#39;703&#39;, &#39;58&#39;: &#39;705&#39;, &#39;59&#39;: &#39;719&#39;, &#39;60&#39;: &#39;720&#39;, &#39;61&#39;: &#39;721&#39;, &#39;62&#39;: &#39;726&#39;, &#39;63&#39;: &#39;728&#39;, &#39;64&#39;: &#39;729&#39;, &#39;65&#39;: &#39;730&#39;, &#39;66&#39;: &#39;732&#39;, &#39;67&#39;: &#39;737&#39;, &#39;68&#39;: &#39;738&#39;, &#39;69&#39;: &#39;739&#39;, &#39;70&#39;: &#39;753&#39;, &#39;71&#39;: &#39;755&#39;, &#39;72&#39;: &#39;756&#39;, &#39;73&#39;: &#39;757&#39;, &#39;74&#39;: &#39;759&#39;, &#39;75&#39;: &#39;800&#39;, &#39;76&#39;: &#39;801&#39;, &#39;77&#39;: &#39;802&#39;, &#39;78&#39;: &#39;807&#39;, &#39;79&#39;: &#39;809&#39;, &#39;80&#39;: &#39;810&#39;, &#39;81&#39;: &#39;811&#39;, &#39;82&#39;: &#39;813&#39;, &#39;83&#39;: &#39;818&#39;, &#39;84&#39;: &#39;819&#39;, &#39;85&#39;: &#39;820&#39;, &#39;86&#39;: &#39;1914&#39;, &#39;87&#39;: &#39;1916&#39;, &#39;88&#39;: &#39;1917&#39;, &#39;89&#39;: &#39;1918&#39;, &#39;90&#39;: &#39;1920&#39;, &#39;91&#39;: &#39;1934&#39;, &#39;92&#39;: &#39;1935&#39;, &#39;93&#39;: &#39;1936&#39;, &#39;94&#39;: &#39;1941&#39;, &#39;95&#39;: &#39;1943&#39;, &#39;96&#39;: &#39;1944&#39;, &#39;97&#39;: &#39;1945&#39;, &#39;98&#39;: &#39;1947&#39;, &#39;99&#39;: &#39;1952&#39;}
</code></pre><p>Maintenant ; Nous savons que chaque résultat est concaténé a la variable <strong>r</strong> donc nous allons tester toutes les possibilités pour obtenir block par block le nombre qui donne le flag fourni.</p>
<p>Exemple :
Si on essaye de chiffrer la chaine : <code>baa</code> , on obtient la sortie : <strong>72964764026</strong></p>
<p>Si on en suit le mapping précédent, on peut décomposer le début de la chaine comme :</p>
<ul>
<li>72 + quelque chose
ou</li>
<li>729 +  quelque chose</li>
</ul>
<p>C&rsquo;est là que les problèmes commencent, certain nombre du mapping contiennent eux-mêmes d&rsquo;autres nombre !</p>
<p>Ainsi, le résultat <strong>739</strong> qui donnerai <code>60</code> peut être décomposé comme <strong>73+9</strong> qui sont aussi dans le mapping est qui donnerai <code>1304</code></p>
<p>On doit donc tester le block suivant s’il peut être décomposé avec les nombres présent dans le mapping.</p>
<p>Reprenons l&rsquo;exemple précédent, on décompose les block un par un</p>
<p>(Rappel | Valeur attendue : <strong>72964764026</strong> )</p>
<ul>
<li>ETAPE 1:</li>
</ul>
<pre tabindex="0"><code>Décomposition n°1 : 72      | Résultat : 12
Décomposition n°2 : 729     | Résultat : 64
</code></pre><ul>
<li>ETAPE 2:</li>
</ul>
<pre tabindex="0"><code>Décomposition n°1 : 72 + 9    | Résultat : 1204
Décomposition n°2 : 729 + 647 | Résultat : 6447
</code></pre><ul>
<li>ETAPE 2:</li>
</ul>
<pre tabindex="0"><code>Décomposition n°1 : 72 + 9 + 647  | Résultat : 120447
Décomposition n°2 : 729 + 647 | Résultat : 6447
</code></pre><ul>
<li>ECT</li>
</ul>
<p>Ici on aura 2 décompositions qui donnent <code>72964764026</code> mais une seule donne la bonne sortie !</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#39;64&#39;</span>, <span style="color:#f1fa8c">&#39;47&#39;</span>, <span style="color:#f1fa8c">&#39;45&#39;</span>, <span style="color:#f1fa8c">&#39;07&#39;</span><span style="color:#ff79c6">]</span> <span style="color:#ff79c6">(</span>64474507<span style="color:#ff79c6">)</span> -&gt; <span style="color:#bd93f9">72964764026</span> -&gt; b<span style="color:#f1fa8c">&#39;baa&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#39;12&#39;</span>, <span style="color:#f1fa8c">&#39;04&#39;</span>, <span style="color:#f1fa8c">&#39;47&#39;</span>, <span style="color:#f1fa8c">&#39;45&#39;</span>, <span style="color:#f1fa8c">&#39;07&#39;</span><span style="color:#ff79c6">]</span> <span style="color:#ff79c6">(</span>1204474507<span style="color:#ff79c6">)</span> -&gt; <span style="color:#bd93f9">72964764026</span> -&gt; None
</span></span></code></pre></div><h5 id="notre-flag">Notre Flag</h5>
<p>J&rsquo;ai donc tenté à la main de décomposer le flag fourni :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">c1</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;242&#34;</span>,<span style="color:#f1fa8c">&#34;71&#34;</span>,<span style="color:#f1fa8c">&#34;267&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;8&#34;</span>,<span style="color:#f1fa8c">&#34;699&#34;</span>,<span style="color:#f1fa8c">&#34;738&#34;</span>,<span style="color:#f1fa8c">&#34;27&#34;</span>,<span style="color:#f1fa8c">&#34;78&#34;</span>,<span style="color:#f1fa8c">&#34;640&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;739&#34;</span>,<span style="color:#f1fa8c">&#34;72&#34;</span>,<span style="color:#f1fa8c">&#34;235&#34;</span>,<span style="color:#f1fa8c">&#34;217&#34;</span>,<span style="color:#f1fa8c">&#34;215&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#f1fa8c">&#34;1&#34;</span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">c2</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;242&#34;</span>,<span style="color:#f1fa8c">&#34;71&#34;</span>,<span style="color:#f1fa8c">&#34;267&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;8&#34;</span>,<span style="color:#f1fa8c">&#34;699&#34;</span>,<span style="color:#f1fa8c">&#34;738&#34;</span>,<span style="color:#f1fa8c">&#34;27&#34;</span>,<span style="color:#f1fa8c">&#34;78&#34;</span>,<span style="color:#f1fa8c">&#34;640&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;73&#34;</span>,<span style="color:#f1fa8c">&#34;9&#34;</span>,<span style="color:#f1fa8c">&#34;72&#34;</span>,<span style="color:#f1fa8c">&#34;235&#34;</span>,<span style="color:#f1fa8c">&#34;217&#34;</span>,<span style="color:#f1fa8c">&#34;215&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;0&#34;</span>,<span style="color:#f1fa8c">&#34;1&#34;</span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">c3</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;242&#34;</span>,<span style="color:#f1fa8c">&#34;71&#34;</span>,<span style="color:#f1fa8c">&#34;267&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;8&#34;</span>,<span style="color:#f1fa8c">&#34;699&#34;</span>,<span style="color:#f1fa8c">&#34;738&#34;</span>,<span style="color:#f1fa8c">&#34;27&#34;</span>,<span style="color:#f1fa8c">&#34;78&#34;</span>,<span style="color:#f1fa8c">&#34;640&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;739&#34;</span>,<span style="color:#f1fa8c">&#34;72&#34;</span>,<span style="color:#f1fa8c">&#34;235&#34;</span>,<span style="color:#f1fa8c">&#34;217&#34;</span>,<span style="color:#f1fa8c">&#34;215&#34;</span>,<span style="color:#f1fa8c">&#34;30&#34;</span>,<span style="color:#f1fa8c">&#34;1&#34;</span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">c4</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;242&#34;</span>,<span style="color:#f1fa8c">&#34;71&#34;</span>,<span style="color:#f1fa8c">&#34;267&#34;</span>,<span style="color:#f1fa8c">&#34;3&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;8&#34;</span>,<span style="color:#f1fa8c">&#34;699&#34;</span>,<span style="color:#f1fa8c">&#34;738&#34;</span>,<span style="color:#f1fa8c">&#34;27&#34;</span>,<span style="color:#f1fa8c">&#34;78&#34;</span>,<span style="color:#f1fa8c">&#34;640&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;639&#34;</span>,<span style="color:#f1fa8c">&#34;1934&#34;</span>,<span style="color:#f1fa8c">&#34;73&#34;</span>,<span style="color:#f1fa8c">&#34;9&#34;</span>,<span style="color:#f1fa8c">&#34;72&#34;</span>,<span style="color:#f1fa8c">&#34;235&#34;</span>,<span style="color:#f1fa8c">&#34;217&#34;</span>,<span style="color:#f1fa8c">&#34;215&#34;</span>,<span style="color:#f1fa8c">&#34;30&#34;</span>,<span style="color:#f1fa8c">&#34;1&#34;</span><span style="color:#ff79c6">]</span>
</span></span></code></pre></div><p>Malheureusement , aucune des décompositions n&rsquo;a fonctionnés :(</p>
<pre tabindex="0"><code>Iflag: 31113824435468814459144916912292523201
Recovered : b&#39;\x17hM\xfbXFtU\xdch\xbe\xb1\x840l\xc1&#39;

Iflag: 311138244354688144591449113412292523201
Recovered : b&#39;\xea\x13\x0b\xd1r\xc0\x8bZ\x9c\x17@D\x05k4\xc1&#39;

Iflag: 31113824435468814459144916912292523101
Recovered : b&#39;\x17hM\xfbXFtU\xdch\xbe\xb1\x840l]&#39;

Iflag: 311138244354688144591449113412292523101
Recovered : b&#39;\xea\x13\x0b\xd1r\xc0\x8bZ\x9c\x17@D\x05k4]&#39;
</code></pre><p>J&rsquo;ai donc écrit ce script qui test tous les possibilités et qui supprimes les chemins impossible sous forme d&rsquo;arbres de combinaisons :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">brute</span>():
</span></span><span style="display:flex;"><span>	flag <span style="color:#ff79c6">=</span> [[<span style="color:#f1fa8c">&#39;&#39;</span>]]
</span></span><span style="display:flex;"><span>	final <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> k <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#8be9fd;font-style:italic">len</span>(out)<span style="color:#ff79c6">//</span><span style="color:#bd93f9">2</span>):
</span></span><span style="display:flex;"><span>		allposs <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">for</span> possibility <span style="color:#ff79c6">in</span> flag:
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>				<span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>					block <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(i)<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(j)
</span></span><span style="display:flex;"><span>					current <span style="color:#ff79c6">=</span> calc(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(possibility)<span style="color:#ff79c6">+</span>block)
</span></span><span style="display:flex;"><span>					<span style="color:#ff79c6">if</span>(out<span style="color:#ff79c6">.</span>startswith(current)):
</span></span><span style="display:flex;"><span>						newlist <span style="color:#ff79c6">=</span> possibility[:]
</span></span><span style="display:flex;"><span>						<span style="color:#ff79c6">if</span> newlist <span style="color:#ff79c6">==</span> [<span style="color:#f1fa8c">&#39;&#39;</span>]:
</span></span><span style="display:flex;"><span>							newlist <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>						newlist<span style="color:#ff79c6">.</span>append(block)
</span></span><span style="display:flex;"><span>						allposs<span style="color:#ff79c6">.</span>append(newlist)
</span></span><span style="display:flex;"><span>						<span style="color:#ff79c6">if</span>(possibility <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">in</span> final):
</span></span><span style="display:flex;"><span>							<span style="color:#ff79c6">if</span>(current <span style="color:#ff79c6">==</span> out):
</span></span><span style="display:flex;"><span>								final<span style="color:#ff79c6">.</span>append(possibility<span style="color:#ff79c6">+</span>[block])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		flag <span style="color:#ff79c6">=</span> allposs
</span></span><span style="display:flex;"><span>		allposs <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(out)
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">for</span> possibility <span style="color:#ff79c6">in</span> flag:
</span></span><span style="display:flex;"><span>			<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">{</span>possibility<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>calc(<span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>decrypt(<span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n\n</span><span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">*</span><span style="color:#bd93f9">50</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34; [*] </span><span style="color:#f1fa8c">{</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">len</span>(final))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> combinaisons trouvés !</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> goodcombi <span style="color:#ff79c6">in</span> final:
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34; </span><span style="color:#f1fa8c">{</span>goodcombi<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> (</span><span style="color:#f1fa8c">{</span><span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(goodcombi)<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">) -&gt; </span><span style="color:#f1fa8c">{</span>calc(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>decrypt(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(goodcombi))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n\n</span><span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">*</span><span style="color:#bd93f9">50</span>)
</span></span></code></pre></div><p>Une fois tous assemblé, voici le code final :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> binascii
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">polinom</span>(n):
</span></span><span style="display:flex;"><span>	i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	z <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>	s <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">while</span> n <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">if</span> n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">2</span> <span style="color:#ff79c6">!=</span> <span style="color:#bd93f9">0</span>:
</span></span><span style="display:flex;"><span>			z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">2</span> <span style="color:#ff79c6">-</span> (n <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">4</span>))
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>			z<span style="color:#ff79c6">.</span>append(<span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>		n <span style="color:#ff79c6">=</span> (n <span style="color:#ff79c6">-</span> z[i])<span style="color:#ff79c6">/</span><span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>		i <span style="color:#ff79c6">=</span> i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>	z <span style="color:#ff79c6">=</span> z[::<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span>	l <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">len</span>(z)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>, l):
</span></span><span style="display:flex;"><span>		 s <span style="color:#ff79c6">+=</span> z[i] <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">3</span> <span style="color:#ff79c6">**</span> (l <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">-</span> i)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">calc</span>(iflag):
</span></span><span style="display:flex;"><span>	i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	r <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">while</span> i <span style="color:#ff79c6">&lt;</span> <span style="color:#8be9fd;font-style:italic">len</span>(<span style="color:#8be9fd;font-style:italic">str</span>(iflag)):
</span></span><span style="display:flex;"><span>		d <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(iflag)[i:i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>]
</span></span><span style="display:flex;"><span>		nf <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(polinom(<span style="color:#8be9fd;font-style:italic">int</span>(d)))
</span></span><span style="display:flex;"><span>		r <span style="color:#ff79c6">+=</span> <span style="color:#8be9fd;font-style:italic">str</span>(nf)
</span></span><span style="display:flex;"><span>		i <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">decrypt</span>(<span style="color:#8be9fd;font-style:italic">input</span>):
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">try</span>:		
</span></span><span style="display:flex;"><span>		hexa <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">hex</span>(<span style="color:#8be9fd;font-style:italic">int</span>(<span style="color:#8be9fd;font-style:italic">input</span>[:<span style="color:#8be9fd;font-style:italic">len</span>(<span style="color:#8be9fd;font-style:italic">input</span>)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span>]<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">input</span>[<span style="color:#8be9fd;font-style:italic">len</span>(<span style="color:#8be9fd;font-style:italic">input</span>)<span style="color:#ff79c6">-</span><span style="color:#bd93f9">2</span>:]<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;0&#39;</span>,<span style="color:#f1fa8c">&#39;&#39;</span>)))
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">return</span> binascii<span style="color:#ff79c6">.</span>unhexlify(<span style="color:#8be9fd;font-style:italic">bytes</span>(hexa[<span style="color:#bd93f9">2</span>:],<span style="color:#f1fa8c">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">except</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">exemple</span>(flag):
</span></span><span style="display:flex;"><span>	decomposition1 <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>	decomposition2 <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>	hflag <span style="color:#ff79c6">=</span> binascii<span style="color:#ff79c6">.</span>hexlify(flag)<span style="color:#ff79c6">.</span>decode()
</span></span><span style="display:flex;"><span>	iflag <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(hflag[<span style="color:#bd93f9">2</span>:], <span style="color:#bd93f9">16</span>)
</span></span><span style="display:flex;"><span>	i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>	r <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">while</span> i <span style="color:#ff79c6">&lt;</span> <span style="color:#8be9fd;font-style:italic">len</span>(<span style="color:#8be9fd;font-style:italic">str</span>(iflag)):
</span></span><span style="display:flex;"><span>		d <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(iflag)[i:i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">2</span>]
</span></span><span style="display:flex;"><span>		nf <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(polinom(<span style="color:#8be9fd;font-style:italic">int</span>(d)))
</span></span><span style="display:flex;"><span>		decomposition1<span style="color:#ff79c6">.</span>append(<span style="color:#8be9fd;font-style:italic">str</span>(nf))
</span></span><span style="display:flex;"><span>		decomposition2<span style="color:#ff79c6">.</span>append(d)
</span></span><span style="display:flex;"><span>		r <span style="color:#ff79c6">+=</span> <span style="color:#8be9fd;font-style:italic">str</span>(nf)
</span></span><span style="display:flex;"><span>		i <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> r,[[decomposition1]<span style="color:#ff79c6">+</span>[decomposition2]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">brute</span>():
</span></span><span style="display:flex;"><span>	flag <span style="color:#ff79c6">=</span> [[<span style="color:#f1fa8c">&#39;&#39;</span>]]
</span></span><span style="display:flex;"><span>	final <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> k <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#8be9fd;font-style:italic">len</span>(out)<span style="color:#ff79c6">//</span><span style="color:#bd93f9">2</span>):
</span></span><span style="display:flex;"><span>		allposs <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">for</span> possibility <span style="color:#ff79c6">in</span> flag:
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>				<span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>					block <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(i)<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(j)
</span></span><span style="display:flex;"><span>					current <span style="color:#ff79c6">=</span> calc(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(possibility)<span style="color:#ff79c6">+</span>block)
</span></span><span style="display:flex;"><span>					<span style="color:#ff79c6">if</span>(out<span style="color:#ff79c6">.</span>startswith(current)):
</span></span><span style="display:flex;"><span>						newlist <span style="color:#ff79c6">=</span> possibility[:]
</span></span><span style="display:flex;"><span>						<span style="color:#ff79c6">if</span> newlist <span style="color:#ff79c6">==</span> [<span style="color:#f1fa8c">&#39;&#39;</span>]:
</span></span><span style="display:flex;"><span>							newlist <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>						newlist<span style="color:#ff79c6">.</span>append(block)
</span></span><span style="display:flex;"><span>						allposs<span style="color:#ff79c6">.</span>append(newlist)
</span></span><span style="display:flex;"><span>						<span style="color:#ff79c6">if</span>(possibility <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">in</span> final):
</span></span><span style="display:flex;"><span>							<span style="color:#ff79c6">if</span>(current <span style="color:#ff79c6">==</span> out):
</span></span><span style="display:flex;"><span>								final<span style="color:#ff79c6">.</span>append(possibility<span style="color:#ff79c6">+</span>[block])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		flag <span style="color:#ff79c6">=</span> allposs
</span></span><span style="display:flex;"><span>		allposs <span style="color:#ff79c6">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(out)
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">for</span> possibility <span style="color:#ff79c6">in</span> flag:
</span></span><span style="display:flex;"><span>			<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">{</span>possibility<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>calc(<span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>decrypt(<span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n\n</span><span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">*</span><span style="color:#bd93f9">50</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34; [*] </span><span style="color:#f1fa8c">{</span><span style="color:#8be9fd;font-style:italic">str</span>(<span style="color:#8be9fd;font-style:italic">len</span>(final))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> combinaisons trouvés !</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> goodcombi <span style="color:#ff79c6">in</span> final:
</span></span><span style="display:flex;"><span>		<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#34; </span><span style="color:#f1fa8c">{</span>goodcombi<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> (</span><span style="color:#f1fa8c">{</span><span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(goodcombi)<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">) -&gt; </span><span style="color:#f1fa8c">{</span>calc(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(possibility))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> -&gt; </span><span style="color:#f1fa8c">{</span>decrypt(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join(goodcombi))<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">\n\n</span><span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;#&#34;</span><span style="color:#ff79c6">*</span><span style="color:#bd93f9">50</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#out,decomposition = exemple(b&#39;abaa&#39;)</span>
</span></span><span style="display:flex;"><span>out,decomposition <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;242712673639869973827786401934639193473972235217215301&#34;</span>,<span style="color:#ff79c6">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>brute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">mapping</span>():
</span></span><span style="display:flex;"><span>	mapping <span style="color:#ff79c6">=</span> {}
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">for</span> j <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(<span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">10</span>):
</span></span><span style="display:flex;"><span>				block <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(i)<span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(j)
</span></span><span style="display:flex;"><span>				val <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(polinom(<span style="color:#8be9fd;font-style:italic">int</span>(block)))
</span></span><span style="display:flex;"><span>				mapping[<span style="color:#8be9fd;font-style:italic">str</span>(block)]<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">str</span>(val)
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> mapping
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(decomposition)
</span></span></code></pre></div><p>Voici le résultat :</p>
<p><img src="./img/out.png" alt="Alt text" title="out">
(<a href="./files/out.txt" >Sortie Complète</a>)</p>
<p>Aprés analyse des résultats, on obtient un message en clair : <code>[ola_th1s_1s_p0l]</code> !</p>
<p>Une fois passé en sha256 ; on obtient le flag :</p>
<pre tabindex="0"><code>CTF{267a4401ea64e7167168969743dcc708399e3823d40e4ae37c78d675e281cb14}
</code></pre>
  </article>

</div>


  </div>
<script type="text/javascript" src="/main.js" defer></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3EGPCQCHEK"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-3EGPCQCHEK', { 'anonymize_ip': false });
}
</script>

</body>

</html>